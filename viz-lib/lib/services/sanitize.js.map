{"version":3,"file":"sanitize.js","names":["_lodash","require","_dompurify","_interopRequireDefault","obj","__esModule","default","DOMPurify","setConfig","ADD_ATTR","addHook","node","target","getAttribute","isString","toLowerCase","setAttribute","removeAttribute","_default","sanitize","exports"],"sources":["../../src/services/sanitize.ts"],"sourcesContent":["import { isString } from \"lodash\";\nimport DOMPurify from \"dompurify\";\n\nDOMPurify.setConfig({\n  ADD_ATTR: [\"target\"],\n});\n\nDOMPurify.addHook(\"afterSanitizeAttributes\", function(node) {\n  // Fix elements with `target` attribute:\n  // - allow only `target=\"_blank\"\n  // - add `rel=\"noopener noreferrer\"` to prevent https://www.owasp.org/index.php/Reverse_Tabnabbing\n\n  const target = node.getAttribute(\"target\");\n  if (isString(target) && target.toLowerCase() === \"_blank\") {\n    node.setAttribute(\"rel\", \"noopener noreferrer\");\n  } else {\n    node.removeAttribute(\"target\");\n  }\n});\n\nexport { DOMPurify };\n\nexport default DOMPurify.sanitize;\n"],"mappings":";;;;;;;;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AACA,IAAAC,UAAA,GAAAC,sBAAA,CAAAF,OAAA;AAAkC,SAAAE,uBAAAC,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAElCG,kBAAS,CAACC,SAAS,CAAC;EAClBC,QAAQ,EAAE,CAAC,QAAQ;AACrB,CAAC,CAAC;AAEFF,kBAAS,CAACG,OAAO,CAAC,yBAAyB,EAAE,UAASC,IAAI,EAAE;EAC1D;EACA;EACA;;EAEA,IAAMC,MAAM,GAAGD,IAAI,CAACE,YAAY,CAAC,QAAQ,CAAC;EAC1C,IAAI,IAAAC,gBAAQ,EAACF,MAAM,CAAC,IAAIA,MAAM,CAACG,WAAW,CAAC,CAAC,KAAK,QAAQ,EAAE;IACzDJ,IAAI,CAACK,YAAY,CAAC,KAAK,EAAE,qBAAqB,CAAC;EACjD,CAAC,MAAM;IACLL,IAAI,CAACM,eAAe,CAAC,QAAQ,CAAC;EAChC;AACF,CAAC,CAAC;AAAC,IAAAC,QAAA,GAIYX,kBAAS,CAACY,QAAQ;AAAAC,OAAA,CAAAd,OAAA,GAAAY,QAAA"}