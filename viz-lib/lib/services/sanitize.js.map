{"version":3,"file":"sanitize.js","names":["isString","DOMPurify","setConfig","ADD_ATTR","addHook","node","target","getAttribute","toLowerCase","setAttribute","removeAttribute","sanitize"],"sources":["../../src/services/sanitize.ts"],"sourcesContent":["import { isString } from \"lodash\";\nimport DOMPurify from \"dompurify\";\n\nDOMPurify.setConfig({\n  ADD_ATTR: [\"target\"],\n});\n\nDOMPurify.addHook(\"afterSanitizeAttributes\", function(node) {\n  // Fix elements with `target` attribute:\n  // - allow only `target=\"_blank\"\n  // - add `rel=\"noopener noreferrer\"` to prevent https://www.owasp.org/index.php/Reverse_Tabnabbing\n\n  const target = node.getAttribute(\"target\");\n  if (isString(target) && target.toLowerCase() === \"_blank\") {\n    node.setAttribute(\"rel\", \"noopener noreferrer\");\n  } else {\n    node.removeAttribute(\"target\");\n  }\n});\n\nexport { DOMPurify };\n\nexport default DOMPurify.sanitize;\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,QAAQ;AACjC,OAAOC,SAAS,MAAM,WAAW;AAEjCA,SAAS,CAACC,SAAS,CAAC;EAClBC,QAAQ,EAAE,CAAC,QAAQ;AACrB,CAAC,CAAC;AAEFF,SAAS,CAACG,OAAO,CAAC,yBAAyB,EAAE,UAASC,IAAI,EAAE;EAC1D;EACA;EACA;;EAEA,IAAMC,MAAM,GAAGD,IAAI,CAACE,YAAY,CAAC,QAAQ,CAAC;EAC1C,IAAIP,QAAQ,CAACM,MAAM,CAAC,IAAIA,MAAM,CAACE,WAAW,CAAC,CAAC,KAAK,QAAQ,EAAE;IACzDH,IAAI,CAACI,YAAY,CAAC,KAAK,EAAE,qBAAqB,CAAC;EACjD,CAAC,MAAM;IACLJ,IAAI,CAACK,eAAe,CAAC,QAAQ,CAAC;EAChC;AACF,CAAC,CAAC;AAEF,SAAST,SAAS;AAElB,eAAeA,SAAS,CAACU,QAAQ"}