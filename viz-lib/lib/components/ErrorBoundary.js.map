{"version":3,"file":"ErrorBoundary.js","names":["_lodash","require","_react","_interopRequireDefault","_debug","_alert","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","logger","debug","ErrorBoundaryContext","React","createContext","handleError","error","setTimeout","reset","exports","ErrorMessage","_ref","children","createElement","message","type","showIcon","defaultProps","ErrorBoundary","Component","constructor","arguments","setState","getDerivedStateFromError","componentDidCatch","isFunction","window","handleException","errorInfo","render","_this$props","props","renderError","state","Provider"],"sources":["../../src/components/ErrorBoundary.tsx"],"sourcesContent":["import { isFunction } from \"lodash\";\nimport React from \"react\";\nimport debug from \"debug\";\nimport Alert from \"antd/lib/alert\";\n\nconst logger = debug(\"redash:errors\");\n\nexport const ErrorBoundaryContext = React.createContext({\n  handleError: (error: any) => {\n    // Allow calling chain to roll up, and then throw the error in global context\n    setTimeout(() => {\n      throw error;\n    });\n  },\n  reset: () => {},\n});\n\ntype OwnErrorMessageProps = {\n  children?: React.ReactNode;\n};\n\ntype ErrorMessageProps = OwnErrorMessageProps & typeof ErrorMessage.defaultProps;\n\nexport function ErrorMessage({ children }: ErrorMessageProps) {\n  return <Alert message={children} type=\"error\" showIcon />;\n}\n\nErrorMessage.defaultProps = {\n  children: \"Something went wrong.\",\n};\n\ntype OwnErrorBoundaryProps = {\n  renderError?: (...args: any[]) => any;\n};\n\ntype ErrorBoundaryState = any;\n\ntype ErrorBoundaryProps = OwnErrorBoundaryProps & typeof ErrorBoundary.defaultProps;\n\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  static defaultProps = {\n    children: null,\n    renderError: null,\n  };\n\n  state = { error: null };\n\n  handleError = (error: any) => {\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'getDerivedStateFromError' does not exist... Remove this comment to see the full error message\n    this.setState(this.constructor.getDerivedStateFromError(error));\n    this.componentDidCatch(error, null);\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'handleException' does not exist on type ... Remove this comment to see the full error message\n    if (isFunction(window.handleException)) {\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'handleException' does not exist on type ... Remove this comment to see the full error message\n      window.handleException(error);\n    }\n  };\n\n  reset = () => {\n    this.setState({ error: null });\n  };\n\n  static getDerivedStateFromError(error: any) {\n    return { error };\n  }\n\n  componentDidCatch(error: any, errorInfo: any) {\n    logger(error, errorInfo);\n  }\n\n  render() {\n    const { renderError, children } = this.props;\n    const { error } = this.state;\n\n    if (error) {\n      if (isFunction(renderError)) {\n        // @ts-expect-error ts-migrate(2349) FIXME: This expression is not callable.\n        return renderError(error);\n      }\n      return <ErrorMessage />;\n    }\n\n    return <ErrorBoundaryContext.Provider value={this}>{children}</ErrorBoundaryContext.Provider>;\n  }\n}\n"],"mappings":"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"}