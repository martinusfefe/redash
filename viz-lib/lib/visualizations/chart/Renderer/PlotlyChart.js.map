{"version":3,"file":"PlotlyChart.js","names":["React","useState","useEffect","useContext","useRef","useMedia","ErrorBoundaryContext","RendererPropTypes","visualizationsSettings","getChartData","initChart","PlotlyChart","_ref","options","data","_useState","_useState2","_slicedToArray","container","setContainer","_useState3","_useState4","chart","setChart","errorHandler","errorHandlerRef","current","isMobile","maxWidth","isMobileRef","isDestroyed","chartData","rows","_chart","error","handleError","initialized","then","destroy","setZoomEnabled","createElement","className","ref","propTypes"],"sources":["../../../../src/visualizations/chart/Renderer/PlotlyChart.tsx"],"sourcesContent":["import React, { useState, useEffect, useContext, useRef } from \"react\";\nimport useMedia from \"use-media\";\nimport { ErrorBoundaryContext } from \"@/components/ErrorBoundary\";\nimport { RendererPropTypes } from \"@/visualizations/prop-types\";\nimport { visualizationsSettings } from \"@/visualizations/visualizationsSettings\";\nimport getChartData from \"../getChartData\";\nimport initChart from \"./initChart\";\n\nexport interface PlotlyChartProps {\n  data: {\n    rows: any[];\n    columns: any[];\n  };\n  options: object;\n}\n\nexport default function PlotlyChart({ options, data }: PlotlyChartProps) {\n  const [container, setContainer] = useState(null);\n  const [chart, setChart] = useState(null);\n\n  const errorHandler = useContext(ErrorBoundaryContext);\n  const errorHandlerRef = useRef();\n  // @ts-expect-error ts-migrate(2322) FIXME: Type '{ handleError: (error: any) => void; reset: ... Remove this comment to see the full error message\n  errorHandlerRef.current = errorHandler;\n\n  const isMobile = useMedia({ maxWidth: 768 });\n  const isMobileRef = useRef();\n  // @ts-expect-error ts-migrate(2322) FIXME: Type 'boolean' is not assignable to type 'undefine... Remove this comment to see the full error message\n  isMobileRef.current = isMobile;\n\n  useEffect(() => {\n    if (container) {\n      let isDestroyed = false;\n\n      const chartData = getChartData(data.rows, options);\n      const _chart = initChart(container, options, chartData, visualizationsSettings, (error: any) => {\n        // @ts-expect-error ts-migrate(2532) FIXME: Object is possibly 'undefined'.\n        errorHandlerRef.current.handleError(error);\n      });\n      _chart.initialized.then(() => {\n        if (!isDestroyed) {\n          setChart(_chart);\n        }\n      });\n      return () => {\n        isDestroyed = true;\n        _chart.destroy();\n      };\n    }\n  }, [options, data, container]);\n\n  useEffect(() => {\n    if (chart) {\n      // @ts-expect-error ts-migrate(2531) FIXME: Object is possibly 'null'.\n      chart.setZoomEnabled(!isMobile);\n    }\n  }, [chart, isMobile]);\n\n  // @ts-expect-error ts-migrate(2322) FIXME: Type 'Dispatch<SetStateAction<null>>' is not assig... Remove this comment to see the full error message\n  return <div className=\"chart-visualization-container\" ref={setContainer} />;\n}\n\nPlotlyChart.propTypes = RendererPropTypes;\n"],"mappings":";;;;;;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,EAAEC,MAAM,QAAQ,OAAO;AACtE,OAAOC,QAAQ,MAAM,WAAW;AAChC,SAASC,oBAAoB;AAC7B,SAASC,iBAAiB;AAC1B,SAASC,sBAAsB;AAC/B,OAAOC,YAAY;AACnB,OAAOC,SAAS;AAUhB,eAAe,SAASC,WAAWA,CAAAC,IAAA,EAAsC;EAAA,IAAnCC,OAAO,GAAAD,IAAA,CAAPC,OAAO;IAAEC,IAAI,GAAAF,IAAA,CAAJE,IAAI;EACjD,IAAAC,SAAA,GAAkCd,QAAQ,CAAC,IAAI,CAAC;IAAAe,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAzCG,SAAS,GAAAF,UAAA;IAAEG,YAAY,GAAAH,UAAA;EAC9B,IAAAI,UAAA,GAA0BnB,QAAQ,CAAC,IAAI,CAAC;IAAAoB,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAAjCE,KAAK,GAAAD,UAAA;IAAEE,QAAQ,GAAAF,UAAA;EAEtB,IAAMG,YAAY,GAAGrB,UAAU,CAACG,oBAAoB,CAAC;EACrD,IAAMmB,eAAe,GAAGrB,MAAM,CAAC,CAAC;EAChC;EACAqB,eAAe,CAACC,OAAO,GAAGF,YAAY;EAEtC,IAAMG,QAAQ,GAAGtB,QAAQ,CAAC;IAAEuB,QAAQ,EAAE;EAAI,CAAC,CAAC;EAC5C,IAAMC,WAAW,GAAGzB,MAAM,CAAC,CAAC;EAC5B;EACAyB,WAAW,CAACH,OAAO,GAAGC,QAAQ;EAE9BzB,SAAS,CAAC,MAAM;IACd,IAAIgB,SAAS,EAAE;MACb,IAAIY,WAAW,GAAG,KAAK;MAEvB,IAAMC,SAAS,GAAGtB,YAAY,CAACK,IAAI,CAACkB,IAAI,EAAEnB,OAAO,CAAC;MAClD,IAAMoB,MAAM,GAAGvB,SAAS,CAACQ,SAAS,EAAEL,OAAO,EAAEkB,SAAS,EAAEvB,sBAAsB,EAAG0B,KAAU,IAAK;QAC9F;QACAT,eAAe,CAACC,OAAO,CAACS,WAAW,CAACD,KAAK,CAAC;MAC5C,CAAC,CAAC;MACFD,MAAM,CAACG,WAAW,CAACC,IAAI,CAAC,MAAM;QAC5B,IAAI,CAACP,WAAW,EAAE;UAChBP,QAAQ,CAACU,MAAM,CAAC;QAClB;MACF,CAAC,CAAC;MACF,OAAO,MAAM;QACXH,WAAW,GAAG,IAAI;QAClBG,MAAM,CAACK,OAAO,CAAC,CAAC;MAClB,CAAC;IACH;EACF,CAAC,EAAE,CAACzB,OAAO,EAAEC,IAAI,EAAEI,SAAS,CAAC,CAAC;EAE9BhB,SAAS,CAAC,MAAM;IACd,IAAIoB,KAAK,EAAE;MACT;MACAA,KAAK,CAACiB,cAAc,CAAC,CAACZ,QAAQ,CAAC;IACjC;EACF,CAAC,EAAE,CAACL,KAAK,EAAEK,QAAQ,CAAC,CAAC;;EAErB;EACA,oBAAO3B,KAAA,CAAAwC,aAAA;IAAKC,SAAS,EAAC,+BAA+B;IAACC,GAAG,EAAEvB;EAAa,CAAE,CAAC;AAC7E;AAEAR,WAAW,CAACgC,SAAS,GAAGpC,iBAAiB"}