{"version":3,"file":"getChartData.js","names":["isNil","isObject","each","forOwn","sortBy","values","addPointToSeries","point","seriesCollection","seriesName","undefined","name","type","data","push","getChartData","options","series","mappings","columnMapping","row","$raw","xValue","yValues","eValue","sizeValue","zValue","value","definition","definitionParts","split","String","yValue","ySeriesName","x","y","yError","size","zVal","_ref","seriesOptions","zIndex"],"sources":["../../../src/visualizations/chart/getChartData.ts"],"sourcesContent":["import { isNil, isObject, each, forOwn, sortBy, values } from \"lodash\";\n\nfunction addPointToSeries(point: any, seriesCollection: any, seriesName: any) {\n  if (seriesCollection[seriesName] === undefined) {\n    seriesCollection[seriesName] = {\n      name: seriesName,\n      type: \"column\",\n      data: [],\n    };\n  }\n\n  seriesCollection[seriesName].data.push(point);\n}\n\nexport default function getChartData(data: any, options: any) {\n  const series = {};\n\n  const mappings = options.columnMapping;\n\n  each(data, row => {\n    let point = { $raw: row };\n    let seriesName = null;\n    let xValue = 0;\n    const yValues = {};\n    let eValue: any = null;\n    let sizeValue: any = null;\n    let zValue: any = null;\n\n    forOwn(row, (value, definition) => {\n      definition = \"\" + definition;\n      const definitionParts = definition.split(\"::\") || definition.split(\"__\");\n      const name = definitionParts[0];\n      const type = mappings ? mappings[definition] : definitionParts[1];\n\n      if (type === \"unused\") {\n        return;\n      }\n\n      if (type === \"x\") {\n        xValue = value;\n        // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n        point[type] = value;\n      }\n      if (type === \"y\") {\n        // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n        yValues[name] = value;\n        // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n        point[type] = value;\n      }\n      if (type === \"yError\") {\n        eValue = value;\n        // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n        point[type] = value;\n      }\n\n      if (type === \"series\") {\n        seriesName = String(value);\n      }\n\n      if (type === \"size\") {\n        // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n        point[type] = value;\n        sizeValue = value;\n      }\n\n      if (type === \"zVal\") {\n        // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n        point[type] = value;\n        zValue = value;\n      }\n\n      if (type === \"multiFilter\" || type === \"multi-filter\") {\n        seriesName = String(value);\n      }\n    });\n\n    if (isNil(seriesName)) {\n      each(yValues, (yValue, ySeriesName) => {\n        // @ts-expect-error ts-migrate(2322) FIXME: Type '{ x: number; y: never; $raw: any; }' is not ... Remove this comment to see the full error message\n        point = { x: xValue, y: yValue, $raw: point.$raw };\n        if (eValue !== null) {\n          // @ts-expect-error ts-migrate(2339) FIXME: Property 'yError' does not exist on type '{ $raw: ... Remove this comment to see the full error message\n          point.yError = eValue;\n        }\n\n        if (sizeValue !== null) {\n          // @ts-expect-error ts-migrate(2339) FIXME: Property 'size' does not exist on type '{ $raw: an... Remove this comment to see the full error message\n          point.size = sizeValue;\n        }\n\n        if (zValue !== null) {\n          // @ts-expect-error ts-migrate(2339) FIXME: Property 'zVal' does not exist on type '{ $raw: an... Remove this comment to see the full error message\n          point.zVal = zValue;\n        }\n        addPointToSeries(point, series, ySeriesName);\n      });\n    } else {\n      addPointToSeries(point, series, seriesName);\n    }\n  });\n  return sortBy(values(series), ({ name }) => {\n    if (isObject(options.seriesOptions[name])) {\n      return options.seriesOptions[name].zIndex || 0;\n    }\n    return 0;\n  });\n}\n"],"mappings":"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"}