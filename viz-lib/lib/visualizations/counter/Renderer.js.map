{"version":3,"file":"Renderer.js","names":["_lodash","require","_react","_interopRequireWildcard","_classnames","_interopRequireDefault","_resizeObserver","_propTypes","_utils","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","Array","from","test","len","length","arr2","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","push","value","err","return","isArray","getCounterStyles","scale","msTransform","concat","MozTransform","WebkitTransform","transform","getCounterScale","container","inner","firstChild","Math","min","offsetWidth","offsetHeight","Number","isFinite","toFixed","Renderer","_ref","data","options","visualizationName","_useState","useState","_useState2","setScale","_useState3","_useState4","setContainer","useEffect","unwatch","resizeObserver","_getCounterData","getCounterData","rows","showTrend","trendPositive","counterValue","counterValueTooltip","targetValue","targetValueTooltip","counterLabel","createElement","className","cx","ref","style","title","propTypes","RendererPropTypes"],"sources":["../../../src/visualizations/counter/Renderer.tsx"],"sourcesContent":["import { isFinite } from \"lodash\";\nimport React, { useState, useEffect } from \"react\";\nimport cx from \"classnames\";\nimport resizeObserver from \"@/services/resizeObserver\";\nimport { RendererPropTypes } from \"@/visualizations/prop-types\";\n\nimport { getCounterData } from \"./utils\";\n\nimport \"./render.less\";\n\nfunction getCounterStyles(scale: any) {\n  return {\n    msTransform: `scale(${scale})`,\n    MozTransform: `scale(${scale})`,\n    WebkitTransform: `scale(${scale})`,\n    transform: `scale(${scale})`,\n  };\n}\n\nfunction getCounterScale(container: any) {\n  const inner = container.firstChild;\n  const scale = Math.min(container.offsetWidth / inner.offsetWidth, container.offsetHeight / inner.offsetHeight);\n  return Number(isFinite(scale) ? scale : 1).toFixed(2); // keep only two decimal places\n}\n\nexport default function Renderer({ data, options, visualizationName }: any) {\n  const [scale, setScale] = useState(\"1.00\");\n  const [container, setContainer] = useState(null);\n\n  useEffect(() => {\n    if (container) {\n      const unwatch = resizeObserver(container, () => {\n        setScale(getCounterScale(container));\n      });\n      return unwatch;\n    }\n  }, [container]);\n\n  useEffect(() => {\n    if (container) {\n      // update scaling when options or data change (new formatting, values, etc.\n      // may change inner container dimensions which will not be tracked by `resizeObserver`);\n      setScale(getCounterScale(container));\n    }\n  }, [data, options, container]);\n\n  const {\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'showTrend' does not exist on type '{}'.\n    showTrend,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'trendPositive' does not exist on type '{... Remove this comment to see the full error message\n    trendPositive,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterValue' does not exist on type '{}... Remove this comment to see the full error message\n    counterValue,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterValueTooltip' does not exist on t... Remove this comment to see the full error message\n    counterValueTooltip,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'targetValue' does not exist on type '{}'... Remove this comment to see the full error message\n    targetValue,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'targetValueTooltip' does not exist on ty... Remove this comment to see the full error message\n    targetValueTooltip,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterLabel' does not exist on type '{}... Remove this comment to see the full error message\n    counterLabel,\n  } = getCounterData(data.rows, options, visualizationName);\n  return (\n    <div\n      className={cx(\"counter-visualization-container\", {\n        \"trend-positive\": showTrend && trendPositive,\n        \"trend-negative\": showTrend && !trendPositive,\n      })}>\n      {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Dispatch<SetStateAction<null>>' is not assig... Remove this comment to see the full error message */}\n      <div className=\"counter-visualization-content\" ref={setContainer}>\n        <div style={getCounterStyles(scale)}>\n          <div className=\"counter-visualization-value\" title={counterValueTooltip}>\n            {counterValue}\n          </div>\n          {targetValue && (\n            <div className=\"counter-visualization-target\" title={targetValueTooltip}>\n              ({targetValue})\n            </div>\n          )}\n          <div className=\"counter-visualization-label\">{counterLabel}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nRenderer.propTypes = RendererPropTypes;\n"],"mappings":"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"}