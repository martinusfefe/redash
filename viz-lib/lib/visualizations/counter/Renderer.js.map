{"version":3,"file":"Renderer.js","names":["isFinite","React","useState","useEffect","cx","resizeObserver","RendererPropTypes","getCounterData","getCounterStyles","scale","msTransform","concat","MozTransform","WebkitTransform","transform","getCounterScale","container","inner","firstChild","Math","min","offsetWidth","offsetHeight","Number","toFixed","Renderer","_ref","data","options","visualizationName","_useState","_useState2","_slicedToArray","setScale","_useState3","_useState4","setContainer","unwatch","_getCounterData","rows","showTrend","trendPositive","counterValue","counterValueTooltip","targetValue","targetValueTooltip","counterLabel","createElement","className","ref","style","title","propTypes"],"sources":["../../../src/visualizations/counter/Renderer.tsx"],"sourcesContent":["import { isFinite } from \"lodash\";\nimport React, { useState, useEffect } from \"react\";\nimport cx from \"classnames\";\nimport resizeObserver from \"@/services/resizeObserver\";\nimport { RendererPropTypes } from \"@/visualizations/prop-types\";\n\nimport { getCounterData } from \"./utils\";\n\nimport \"./render.less\";\n\nfunction getCounterStyles(scale: any) {\n  return {\n    msTransform: `scale(${scale})`,\n    MozTransform: `scale(${scale})`,\n    WebkitTransform: `scale(${scale})`,\n    transform: `scale(${scale})`,\n  };\n}\n\nfunction getCounterScale(container: any) {\n  const inner = container.firstChild;\n  const scale = Math.min(container.offsetWidth / inner.offsetWidth, container.offsetHeight / inner.offsetHeight);\n  return Number(isFinite(scale) ? scale : 1).toFixed(2); // keep only two decimal places\n}\n\nexport default function Renderer({ data, options, visualizationName }: any) {\n  const [scale, setScale] = useState(\"1.00\");\n  const [container, setContainer] = useState(null);\n\n  useEffect(() => {\n    if (container) {\n      const unwatch = resizeObserver(container, () => {\n        setScale(getCounterScale(container));\n      });\n      return unwatch;\n    }\n  }, [container]);\n\n  useEffect(() => {\n    if (container) {\n      // update scaling when options or data change (new formatting, values, etc.\n      // may change inner container dimensions which will not be tracked by `resizeObserver`);\n      setScale(getCounterScale(container));\n    }\n  }, [data, options, container]);\n\n  const {\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'showTrend' does not exist on type '{}'.\n    showTrend,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'trendPositive' does not exist on type '{... Remove this comment to see the full error message\n    trendPositive,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterValue' does not exist on type '{}... Remove this comment to see the full error message\n    counterValue,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterValueTooltip' does not exist on t... Remove this comment to see the full error message\n    counterValueTooltip,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'targetValue' does not exist on type '{}'... Remove this comment to see the full error message\n    targetValue,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'targetValueTooltip' does not exist on ty... Remove this comment to see the full error message\n    targetValueTooltip,\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterLabel' does not exist on type '{}... Remove this comment to see the full error message\n    counterLabel,\n  } = getCounterData(data.rows, options, visualizationName);\n  return (\n    <div\n      className={cx(\"counter-visualization-container\", {\n        \"trend-positive\": showTrend && trendPositive,\n        \"trend-negative\": showTrend && !trendPositive,\n      })}>\n      {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Dispatch<SetStateAction<null>>' is not assig... Remove this comment to see the full error message */}\n      <div className=\"counter-visualization-content\" ref={setContainer}>\n        <div style={getCounterStyles(scale)}>\n          <div className=\"counter-visualization-value\" title={counterValueTooltip}>\n            {counterValue}\n          </div>\n          {targetValue && (\n            <div className=\"counter-visualization-target\" title={targetValueTooltip}>\n              ({targetValue})\n            </div>\n          )}\n          <div className=\"counter-visualization-label\">{counterLabel}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nRenderer.propTypes = RendererPropTypes;\n"],"mappings":"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"}