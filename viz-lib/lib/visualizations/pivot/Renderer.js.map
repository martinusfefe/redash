{"version":3,"file":"Renderer.js","names":["React","useState","useEffect","useMemo","get","find","pick","map","mapValues","PivotTableUI","RendererPropTypes","formatColumnValue","VALID_OPTIONS","formatRows","_ref","rows","columns","row","value","key","name","type","Renderer","_ref2","data","options","onOptionsChange","_useState","_objectSpread","_useState2","_slicedToArray","config","setConfig","dataRows","onChange","updatedOptions","validOptions","hideControls","hideRowTotals","hideColumnTotals","createElement","className","_extends","propTypes","defaultProps"],"sources":["../../../src/visualizations/pivot/Renderer.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\nimport { get, find, pick, map, mapValues } from \"lodash\";\n// @ts-expect-error ts-migrate(7016) FIXME: Could not find a declaration file for module 'reac... Remove this comment to see the full error message\nimport PivotTableUI from \"react-pivottable/PivotTableUI\";\nimport { RendererPropTypes } from \"@/visualizations/prop-types\";\nimport { formatColumnValue } from \"@/lib/utils\";\n\nimport \"react-pivottable/pivottable.css\";\nimport \"./renderer.less\";\n\nconst VALID_OPTIONS = [\n  \"rows\",\n  \"cols\",\n  \"vals\",\n  \"aggregatorName\",\n  \"valueFilter\",\n  \"sorters\",\n  \"rowOrder\",\n  \"colOrder\",\n  \"derivedAttributes\",\n  \"rendererName\",\n  \"hiddenAttributes\",\n  \"hiddenFromAggregators\",\n  \"hiddenFromDragDrop\",\n  \"menuLimit\",\n  \"unusedOrientationCutoff\",\n  \"controls\",\n  \"rendererOptions\",\n];\n\nfunction formatRows({ rows, columns }: any) {\n  return map(rows, row => mapValues(row, (value, key) => formatColumnValue(value, find(columns, { name: key }).type)));\n}\n\nexport default function Renderer({ data, options, onOptionsChange }: any) {\n  const [config, setConfig] = useState({ ...options });\n  const dataRows = useMemo(() => formatRows(data), [data]);\n\n  useEffect(() => {\n    setConfig({ ...options });\n  }, [options]);\n\n  const onChange = (updatedOptions: any) => {\n    const validOptions = pick(updatedOptions, VALID_OPTIONS);\n    setConfig({ ...validOptions });\n    onOptionsChange(validOptions);\n  };\n\n  // Legacy behavior: hideControls when controls.enabled is true\n  const hideControls = get(options, \"controls.enabled\");\n  const hideRowTotals = !get(options, \"rendererOptions.table.rowTotals\");\n  const hideColumnTotals = !get(options, \"rendererOptions.table.colTotals\");\n  return (\n    <div\n      className=\"pivot-table-visualization-container\"\n      data-hide-controls={hideControls || null}\n      data-hide-row-totals={hideRowTotals || null}\n      data-hide-column-totals={hideColumnTotals || null}\n      data-test=\"PivotTableVisualization\">\n      <PivotTableUI {...pick(config, VALID_OPTIONS)} data={dataRows} onChange={onChange} />\n    </div>\n  );\n}\n\nRenderer.propTypes = RendererPropTypes;\nRenderer.defaultProps = { onOptionsChange: () => {} };\n"],"mappings":"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"}