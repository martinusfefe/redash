{"version":3,"file":"BoundsSettings.js","names":["_lodash","require","_react","_interopRequireWildcard","_useDebounce","Grid","_editor","_propTypes","_useLoadGeoJson3","_interopRequireDefault","_utils","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","Array","from","test","len","length","arr2","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","push","value","err","return","isArray","BoundsSettings","_ref","options","onOptionsChange","_useState","useState","bounds","_useState2","setBounds","_useDebouncedCallback","useDebouncedCallback","_useDebouncedCallback2","onOptionsChangeDebounced","_useLoadGeoJson","useLoadGeoJson","mapType","_useLoadGeoJson2","geoJson","useEffect","defaultBounds","getGeoJsonBounds","updateBounds","useCallback","j","v","parseFloat","isFinite","newBounds","cloneDeep","boundsAvailable","createElement","Fragment","Section","ControlLabel","label","Row","gutter","Col","span","InputNumber","disabled","undefined","onChange","propTypes","EditorPropTypes"],"sources":["../../../../src/visualizations/choropleth/Editor/BoundsSettings.tsx"],"sourcesContent":["import { isArray, isFinite, cloneDeep } from \"lodash\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { useDebouncedCallback } from \"use-debounce\";\nimport * as Grid from \"antd/lib/grid\";\nimport { Section, InputNumber, ControlLabel } from \"@/components/visualizations/editor\";\nimport { EditorPropTypes } from \"@/visualizations/prop-types\";\n\nimport useLoadGeoJson from \"../hooks/useLoadGeoJson\";\nimport { getGeoJsonBounds } from \"./utils\";\n\nexport default function BoundsSettings({ options, onOptionsChange }: any) {\n  // Bounds may be changed in editor or on preview (by drag/zoom map).\n  // Changes from preview does not come frequently (only when user release mouse button),\n  // but changes from editor should be debounced.\n  // Therefore this component has intermediate state to hold immediate user input,\n  // which is updated from `options.bounds` and by inputs immediately on user input,\n  // but `onOptionsChange` event is debounced and uses last value from internal state.\n\n  const [bounds, setBounds] = useState(options.bounds);\n  const [onOptionsChangeDebounced] = useDebouncedCallback(onOptionsChange, 200);\n\n  const [geoJson] = useLoadGeoJson(options.mapType);\n\n  // `options.bounds` could be empty only if user didn't edit bounds yet - through preview or in this editor.\n  // In this case we should keep empty bounds value because it tells renderer to fit map every time.\n  useEffect(() => {\n    if (options.bounds) {\n      setBounds(options.bounds);\n    } else {\n      const defaultBounds = getGeoJsonBounds(geoJson);\n      if (defaultBounds) {\n        setBounds(defaultBounds);\n      }\n    }\n  }, [options.bounds, geoJson]);\n\n  const updateBounds = useCallback(\n    (i, j, v) => {\n      v = parseFloat(v); // InputNumber may emit `null` and empty strings instead of numbers\n      if (isFinite(v)) {\n        const newBounds = cloneDeep(bounds);\n        newBounds[i][j] = v;\n        setBounds(newBounds);\n        onOptionsChangeDebounced({ bounds: newBounds });\n      }\n    },\n    [bounds, onOptionsChangeDebounced]\n  );\n\n  const boundsAvailable = isArray(bounds);\n\n  return (\n    <React.Fragment>\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'string' is not assignable to type 'null | un... Remove this comment to see the full error message */}\n        <ControlLabel label=\"North-East Latitude and Longitude\">\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\n          <Grid.Row gutter={15}>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[1][0] : undefined}\n                onChange={(value: any) => updateBounds(1, 0, value)}\n              />\n            </Grid.Col>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[1][1] : undefined}\n                onChange={(value: any) => updateBounds(1, 1, value)}\n              />\n            </Grid.Col>\n          </Grid.Row>\n        </ControlLabel>\n      </Section>\n\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'string' is not assignable to type 'null | un... Remove this comment to see the full error message */}\n        <ControlLabel label=\"South-West Latitude and Longitude\">\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\n          <Grid.Row gutter={15}>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[0][0] : undefined}\n                onChange={(value: any) => updateBounds(0, 0, value)}\n              />\n            </Grid.Col>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[0][1] : undefined}\n                onChange={(value: any) => updateBounds(0, 1, value)}\n              />\n            </Grid.Col>\n          </Grid.Row>\n        </ControlLabel>\n      </Section>\n    </React.Fragment>\n  );\n}\n\nBoundsSettings.propTypes = EditorPropTypes;\n"],"mappings":"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"}