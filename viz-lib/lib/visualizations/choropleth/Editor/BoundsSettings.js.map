{"version":3,"file":"BoundsSettings.js","names":["isArray","isFinite","cloneDeep","React","useState","useEffect","useCallback","useDebouncedCallback","Grid","Section","InputNumber","ControlLabel","EditorPropTypes","useLoadGeoJson","getGeoJsonBounds","BoundsSettings","_ref","options","onOptionsChange","_useState","bounds","_useState2","_slicedToArray","setBounds","_useDebouncedCallback","_useDebouncedCallback2","onOptionsChangeDebounced","_useLoadGeoJson","mapType","_useLoadGeoJson2","geoJson","defaultBounds","updateBounds","i","j","v","parseFloat","newBounds","boundsAvailable","createElement","Fragment","label","Row","gutter","Col","span","disabled","value","undefined","onChange","propTypes"],"sources":["../../../../src/visualizations/choropleth/Editor/BoundsSettings.tsx"],"sourcesContent":["import { isArray, isFinite, cloneDeep } from \"lodash\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { useDebouncedCallback } from \"use-debounce\";\nimport * as Grid from \"antd/lib/grid\";\nimport { Section, InputNumber, ControlLabel } from \"@/components/visualizations/editor\";\nimport { EditorPropTypes } from \"@/visualizations/prop-types\";\n\nimport useLoadGeoJson from \"../hooks/useLoadGeoJson\";\nimport { getGeoJsonBounds } from \"./utils\";\n\nexport default function BoundsSettings({ options, onOptionsChange }: any) {\n  // Bounds may be changed in editor or on preview (by drag/zoom map).\n  // Changes from preview does not come frequently (only when user release mouse button),\n  // but changes from editor should be debounced.\n  // Therefore this component has intermediate state to hold immediate user input,\n  // which is updated from `options.bounds` and by inputs immediately on user input,\n  // but `onOptionsChange` event is debounced and uses last value from internal state.\n\n  const [bounds, setBounds] = useState(options.bounds);\n  const [onOptionsChangeDebounced] = useDebouncedCallback(onOptionsChange, 200);\n\n  const [geoJson] = useLoadGeoJson(options.mapType);\n\n  // `options.bounds` could be empty only if user didn't edit bounds yet - through preview or in this editor.\n  // In this case we should keep empty bounds value because it tells renderer to fit map every time.\n  useEffect(() => {\n    if (options.bounds) {\n      setBounds(options.bounds);\n    } else {\n      const defaultBounds = getGeoJsonBounds(geoJson);\n      if (defaultBounds) {\n        setBounds(defaultBounds);\n      }\n    }\n  }, [options.bounds, geoJson]);\n\n  const updateBounds = useCallback(\n    (i, j, v) => {\n      v = parseFloat(v); // InputNumber may emit `null` and empty strings instead of numbers\n      if (isFinite(v)) {\n        const newBounds = cloneDeep(bounds);\n        newBounds[i][j] = v;\n        setBounds(newBounds);\n        onOptionsChangeDebounced({ bounds: newBounds });\n      }\n    },\n    [bounds, onOptionsChangeDebounced]\n  );\n\n  const boundsAvailable = isArray(bounds);\n\n  return (\n    <React.Fragment>\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'string' is not assignable to type 'null | un... Remove this comment to see the full error message */}\n        <ControlLabel label=\"North-East Latitude and Longitude\">\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\n          <Grid.Row gutter={15}>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[1][0] : undefined}\n                onChange={(value: any) => updateBounds(1, 0, value)}\n              />\n            </Grid.Col>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[1][1] : undefined}\n                onChange={(value: any) => updateBounds(1, 1, value)}\n              />\n            </Grid.Col>\n          </Grid.Row>\n        </ControlLabel>\n      </Section>\n\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'string' is not assignable to type 'null | un... Remove this comment to see the full error message */}\n        <ControlLabel label=\"South-West Latitude and Longitude\">\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\n          <Grid.Row gutter={15}>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[0][0] : undefined}\n                onChange={(value: any) => updateBounds(0, 0, value)}\n              />\n            </Grid.Col>\n            <Grid.Col span={12}>\n              <InputNumber\n                disabled={!boundsAvailable}\n                value={boundsAvailable ? bounds[0][1] : undefined}\n                onChange={(value: any) => updateBounds(0, 1, value)}\n              />\n            </Grid.Col>\n          </Grid.Row>\n        </ControlLabel>\n      </Section>\n    </React.Fragment>\n  );\n}\n\nBoundsSettings.propTypes = EditorPropTypes;\n"],"mappings":"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"}