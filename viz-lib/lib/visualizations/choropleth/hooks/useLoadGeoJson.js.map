{"version":3,"file":"useLoadGeoJson.js","names":["isString","isObject","get","useState","useEffect","axios","visualizationsSettings","createReferenceCountingCache","cache","useLoadGeoJson","mapType","_useState","_useState2","_slicedToArray","geoJson","setGeoJson","_useState3","_useState4","isLoading","setIsLoading","mapUrl","concat","undefined","cancelled","promise","catch","then","_ref","data","release"],"sources":["../../../../src/visualizations/choropleth/hooks/useLoadGeoJson.ts"],"sourcesContent":["import { isString, isObject, get } from \"lodash\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { visualizationsSettings } from \"@/visualizations/visualizationsSettings\";\nimport createReferenceCountingCache from \"@/lib/referenceCountingCache\";\n\nconst cache = createReferenceCountingCache();\n\nexport default function useLoadGeoJson(mapType: any) {\n  const [geoJson, setGeoJson] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    const mapUrl = get(visualizationsSettings, `choroplethAvailableMaps.${mapType}.url`, undefined);\n\n    if (isString(mapUrl)) {\n      setIsLoading(true);\n      let cancelled = false;\n\n      const promise = cache.get(mapUrl, () => axios.get(mapUrl).catch(() => null));\n      promise.then(({ data }: any) => {\n        if (!cancelled) {\n          // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'object | null' is not assignable... Remove this comment to see the full error message\n          setGeoJson(isObject(data) ? data : null);\n          setIsLoading(false);\n        }\n      });\n\n      return () => {\n        cancelled = true;\n        cache.release(mapUrl);\n      };\n    } else {\n      setGeoJson(null);\n      setIsLoading(false);\n    }\n  }, [mapType]);\n\n  return [geoJson, isLoading];\n}\n"],"mappings":";;;;;;AAAA,SAASA,QAAQ,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,QAAQ;AAChD,SAASC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,sBAAsB;AAC/B,OAAOC,4BAA4B;AAEnC,IAAMC,KAAK,GAAGD,4BAA4B,CAAC,CAAC;AAE5C,eAAe,SAASE,cAAcA,CAACC,OAAY,EAAE;EACnD,IAAAC,SAAA,GAA8BR,QAAQ,CAAC,IAAI,CAAC;IAAAS,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAArCG,OAAO,GAAAF,UAAA;IAAEG,UAAU,GAAAH,UAAA;EAC1B,IAAAI,UAAA,GAAkCb,QAAQ,CAAC,KAAK,CAAC;IAAAc,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAA1CE,SAAS,GAAAD,UAAA;IAAEE,YAAY,GAAAF,UAAA;EAE9Bb,SAAS,CAAC,MAAM;IACd,IAAMgB,MAAM,GAAGlB,GAAG,CAACI,sBAAsB,6BAAAe,MAAA,CAA6BX,OAAO,WAAQY,SAAS,CAAC;IAE/F,IAAItB,QAAQ,CAACoB,MAAM,CAAC,EAAE;MACpBD,YAAY,CAAC,IAAI,CAAC;MAClB,IAAII,SAAS,GAAG,KAAK;MAErB,IAAMC,OAAO,GAAGhB,KAAK,CAACN,GAAG,CAACkB,MAAM,EAAE,MAAMf,KAAK,CAACH,GAAG,CAACkB,MAAM,CAAC,CAACK,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC;MAC5ED,OAAO,CAACE,IAAI,CAACC,IAAA,IAAmB;QAAA,IAAhBC,IAAI,GAAAD,IAAA,CAAJC,IAAI;QAClB,IAAI,CAACL,SAAS,EAAE;UACd;UACAR,UAAU,CAACd,QAAQ,CAAC2B,IAAI,CAAC,GAAGA,IAAI,GAAG,IAAI,CAAC;UACxCT,YAAY,CAAC,KAAK,CAAC;QACrB;MACF,CAAC,CAAC;MAEF,OAAO,MAAM;QACXI,SAAS,GAAG,IAAI;QAChBf,KAAK,CAACqB,OAAO,CAACT,MAAM,CAAC;MACvB,CAAC;IACH,CAAC,MAAM;MACLL,UAAU,CAAC,IAAI,CAAC;MAChBI,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC,EAAE,CAACT,OAAO,CAAC,CAAC;EAEb,OAAO,CAACI,OAAO,EAAEI,SAAS,CAAC;AAC7B"}