{"version":3,"file":"useLoadGeoJson.js","names":["_lodash","require","_react","_axios","_interopRequireDefault","_visualizationsSettings","_referenceCountingCache","obj","__esModule","default","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","len","length","arr2","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","push","value","err","return","isArray","cache","createReferenceCountingCache","useLoadGeoJson","mapType","_useState","useState","_useState2","geoJson","setGeoJson","_useState3","_useState4","isLoading","setIsLoading","useEffect","mapUrl","get","visualizationsSettings","concat","undefined","isString","cancelled","promise","axios","catch","then","_ref","data","isObject","release"],"sources":["../../../../src/visualizations/choropleth/hooks/useLoadGeoJson.ts"],"sourcesContent":["import { isString, isObject, get } from \"lodash\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { visualizationsSettings } from \"@/visualizations/visualizationsSettings\";\nimport createReferenceCountingCache from \"@/lib/referenceCountingCache\";\n\nconst cache = createReferenceCountingCache();\n\nexport default function useLoadGeoJson(mapType: any) {\n  const [geoJson, setGeoJson] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    const mapUrl = get(visualizationsSettings, `choroplethAvailableMaps.${mapType}.url`, undefined);\n\n    if (isString(mapUrl)) {\n      setIsLoading(true);\n      let cancelled = false;\n\n      const promise = cache.get(mapUrl, () => axios.get(mapUrl).catch(() => null));\n      promise.then(({ data }: any) => {\n        if (!cancelled) {\n          // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'object | null' is not assignable... Remove this comment to see the full error message\n          setGeoJson(isObject(data) ? data : null);\n          setIsLoading(false);\n        }\n      });\n\n      return () => {\n        cancelled = true;\n        cache.release(mapUrl);\n      };\n    } else {\n      setGeoJson(null);\n      setIsLoading(false);\n    }\n  }, [mapType]);\n\n  return [geoJson, isLoading];\n}\n"],"mappings":"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"}