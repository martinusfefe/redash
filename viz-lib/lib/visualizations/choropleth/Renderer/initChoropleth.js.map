{"version":3,"file":"initChoropleth.js","names":["_lodash","require","_react","_interopRequireDefault","_reactDom","_leaflet","_valueFormat","_sanitize","_resizeObserver","_utils","_Legend","obj","__esModule","default","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","CustomControl","L","Control","extend","options","position","onAdd","div","document","createElement","className","style","background","backgroundClip","onRemove","ReactDOM","unmountComponentAtNode","getContainer","prepareLayer","_ref","feature","layer","data","limits","colors","formatValue","getValueForFeature","targetField","valueFormatted","featureData","prepareFeatureProperties","color","getColorByValue","noValue","setStyle","borders","weight","fillColor","fillOpacity","tooltip","enabled","bindTooltip","sanitize","formatSimpleTemplate","template","sticky","popup","bindPopup","on","darkenColor","validateBounds","bounds","fallbackBounds","latLngBounds","isValid","initChoropleth","container","onBoundsChange","_map","map","center","zoom","zoomSnap","scrollWheelZoom","maxBoundsViscosity","attributionControl","fullscreenControl","_choropleth","_legend","handleMapBoundsChange","isFunction","getBounds","_southWest","lat","lng","_northEast","boundsChangedFromMap","onMapMoveEnd","off","updateLayers","geoJson","eachLayer","removeLayer","removeControl","isObject","isArray","features","setMaxBounds","_createScale","createScale","legend","createNumberFormatter","valueFormat","noValuePlaceholder","geoJSON","onEachFeature","addTo","mapBounds","fitBounds","animate","duration","maxBounds","panInsideBounds","visible","setPosition","replace","addControl","render","items","item","text","limit","alignText","updateBounds","layerBounds","unwatchResize","resizeObserver","invalidateSize","destroy","remove"],"sources":["../../../../src/visualizations/choropleth/Renderer/initChoropleth.tsx"],"sourcesContent":["import { isFunction, isObject, isArray, map } from \"lodash\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-fullscreen\";\nimport \"leaflet-fullscreen/dist/leaflet.fullscreen.css\";\nimport { formatSimpleTemplate } from \"@/lib/value-format\";\nimport sanitize from \"@/services/sanitize\";\nimport resizeObserver from \"@/services/resizeObserver\";\nimport {\n  createNumberFormatter,\n  createScale,\n  darkenColor,\n  getColorByValue,\n  getValueForFeature,\n  prepareFeatureProperties,\n} from \"./utils\";\nimport Legend from \"./Legend\";\n\nconst CustomControl = L.Control.extend({\n  options: {\n    position: \"topright\",\n  },\n  onAdd() {\n    const div = document.createElement(\"div\");\n    div.className = \"leaflet-bar leaflet-custom-toolbar\";\n    div.style.background = \"#fff\";\n    div.style.backgroundClip = \"padding-box\";\n    return div;\n  },\n  onRemove() {\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'getContainer' does not exist on type '{ ... Remove this comment to see the full error message\n    ReactDOM.unmountComponentAtNode(this.getContainer());\n  },\n});\n\nfunction prepareLayer({ feature, layer, data, options, limits, colors, formatValue }: any) {\n  const value = getValueForFeature(feature, data, options.targetField);\n  const valueFormatted = formatValue(value);\n  const featureData = prepareFeatureProperties(feature, valueFormatted, data, options.targetField);\n  const color = getColorByValue(value, limits, colors, options.colors.noValue);\n\n  layer.setStyle({\n    color: options.colors.borders,\n    weight: 1,\n    fillColor: color,\n    fillOpacity: 1,\n  });\n\n  if (options.tooltip.enabled) {\n    layer.bindTooltip(sanitize(formatSimpleTemplate(options.tooltip.template, featureData)), { sticky: true });\n  }\n\n  if (options.popup.enabled) {\n    layer.bindPopup(sanitize(formatSimpleTemplate(options.popup.template, featureData)));\n  }\n\n  layer.on(\"mouseover\", () => {\n    layer.setStyle({\n      weight: 2,\n      fillColor: darkenColor(color),\n    });\n  });\n  layer.on(\"mouseout\", () => {\n    layer.setStyle({\n      weight: 1,\n      fillColor: color,\n    });\n  });\n}\n\nfunction validateBounds(bounds: any, fallbackBounds: any) {\n  if (bounds) {\n    bounds = L.latLngBounds(bounds[0], bounds[1]);\n    if (bounds.isValid()) {\n      return bounds;\n    }\n  }\n  if (fallbackBounds && fallbackBounds.isValid()) {\n    return fallbackBounds;\n  }\n  return null;\n}\n\nexport default function initChoropleth(container: any, onBoundsChange: any) {\n  const _map = L.map(container, {\n    center: [0.0, 0.0],\n    zoom: 1,\n    zoomSnap: 0,\n    scrollWheelZoom: false,\n    maxBoundsViscosity: 1,\n    attributionControl: false,\n    // @ts-expect-error ts-migrate(2345) FIXME: Argument of type '{ center: [number, number]; zoom... Remove this comment to see the full error message\n    fullscreenControl: true,\n  });\n  let _choropleth: any = null;\n  const _legend = new CustomControl();\n\n  function handleMapBoundsChange() {\n    if (isFunction(onBoundsChange)) {\n      const bounds = _map.getBounds();\n      onBoundsChange([\n        // @ts-expect-error ts-migrate(2551) FIXME: Property '_southWest' does not exist on type 'LatL... Remove this comment to see the full error message\n        [bounds._southWest.lat, bounds._southWest.lng],\n        // @ts-expect-error ts-migrate(2551) FIXME: Property '_northEast' does not exist on type 'LatL... Remove this comment to see the full error message\n        [bounds._northEast.lat, bounds._northEast.lng],\n      ]);\n    }\n  }\n\n  let boundsChangedFromMap = false;\n  const onMapMoveEnd = () => {\n    handleMapBoundsChange();\n  };\n  _map.on(\"focus\", () => {\n    boundsChangedFromMap = true;\n    _map.on(\"moveend\", onMapMoveEnd);\n  });\n  _map.on(\"blur\", () => {\n    _map.off(\"moveend\", onMapMoveEnd);\n    boundsChangedFromMap = false;\n  });\n\n  function updateLayers(geoJson: any, data: any, options: any) {\n    _map.eachLayer(layer => _map.removeLayer(layer));\n    _map.removeControl(_legend);\n\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'features' does not exist on type 'object... Remove this comment to see the full error message\n    if (!isObject(geoJson) || !isArray(geoJson.features)) {\n      _choropleth = null;\n      // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'null' is not assignable to param... Remove this comment to see the full error message\n      _map.setMaxBounds(null);\n      return;\n    }\n\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'features' does not exist on type 'object... Remove this comment to see the full error message\n    const { limits, colors, legend } = createScale(geoJson.features, data, options);\n    const formatValue = createNumberFormatter(options.valueFormat, options.noValuePlaceholder);\n\n    // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'object' is not assignable to par... Remove this comment to see the full error message\n    _choropleth = L.geoJSON(geoJson, {\n      onEachFeature(feature, layer) {\n        prepareLayer({ feature, layer, data, options, limits, colors, formatValue });\n      },\n    }).addTo(_map);\n\n    const mapBounds = _choropleth.getBounds();\n    const bounds = validateBounds(options.bounds, mapBounds);\n    _map.fitBounds(bounds, { animate: false, duration: 0 });\n\n    // equivalent to `_map.setMaxBounds(mapBounds)` but without animation\n    _map.options.maxBounds = mapBounds;\n    _map.panInsideBounds(mapBounds, { animate: false, duration: 0 });\n\n    // update legend\n    if (options.legend.visible && legend.length > 0) {\n      _legend.setPosition(options.legend.position.replace(\"-\", \"\"));\n      _map.addControl(_legend);\n      ReactDOM.render(\n        // @ts-expect-error ts-migrate(2769) FIXME: No overload matches this call.\n        <Legend\n          // @ts-expect-error ts-migrate(2322) FIXME: Type '{ text: any; color: any; limit: any; }[]' is... Remove this comment to see the full error message\n          items={map(legend, item => ({ ...item, text: formatValue(item.limit) }))}\n          alignText={options.legend.alignText}\n        />,\n        _legend.getContainer()\n      );\n    }\n  }\n\n  function updateBounds(bounds: any) {\n    if (!boundsChangedFromMap) {\n      const layerBounds = _choropleth ? _choropleth.getBounds() : _map.getBounds();\n      bounds = validateBounds(bounds, layerBounds);\n      if (bounds) {\n        _map.fitBounds(bounds, { animate: false, duration: 0 });\n      }\n    }\n  }\n\n  const unwatchResize = resizeObserver(container, () => {\n    _map.invalidateSize(false);\n  });\n\n  return {\n    updateLayers,\n    updateBounds,\n    destroy() {\n      unwatchResize();\n      _map.removeControl(_legend); // _map.remove() does not cleanup controls - bug in Leaflet?\n      _map.remove();\n    },\n  };\n}\n"],"mappings":"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"}